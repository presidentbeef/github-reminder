#!/usr/bin/env ruby
require_relative '../lib/issues'

user, repo, token = ARGV

unless token then
  hub_config = File.expand_path "~/.config/hub"

  if File.file? hub_config then
    require "yaml"
    config = YAML.load File.read hub_config
    token  = config.dig("github.com", 0, "oauth_token")
  end
end

abort "Usage: github-reminder [user] [repo] [token]" unless user && repo && token

issues = Issues.new(user, repo, token)

puts

iss = issues.issues_with_no_response

if iss.any?
  puts "Issues with no response yet:"
  puts
  iss.each do |i|
    puts "\t#{i.pretty}"
    puts "\t\t#{i.link}"
    puts
  end
end

prs = issues.prs_with_no_response

if prs.any?
  puts "Pull requests with no response yet:"
  prs.each do |i|
    puts "\t#{i.pretty}"
    puts "\t\t#{i.link}"
    puts
  end
end
